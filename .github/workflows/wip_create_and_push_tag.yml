name: 'Create and push tag from package version'

on:
  workflow_dispatch:
    inputs:
      commitHash:
        description: 'Hash du commit Ã  dÃ©ployer (ex: cadd172232c80206107e2f0122542adf19fb42af)'
        required: true
        type: string

      releaseNumber:
        description: "NumÃ©ro de l'itÃ©ration (ex: 199)"
        required: true
        type: string

jobs:
  create_an_push_tag:
    runs-on: [self-hosted, linux, x64, regular]
    # env:
    #   GIT_CONFIG_EMAIL: github-actions-bot@passculture.app
    #   GIT_CONFIG_NAME: ${{ github.actor }}
    steps:
      - name: Checkout commit hash
        uses: actions/checkout@v3
        with:
          ref: ${{ inputs.commitHash }}
          token: ${{ secrets.PUSH_SERVICE_ACCOUNT }}
      # - name: Set up Node.js
      #   uses: actions/setup-node@v2
      #   with:
      #     node-version: '14'
      # - name: Author
      #   run: |
      #     git config --global user.email "$GIT_CONFIG_EMAIL"
      #     git config --global user.name "$GIT_CONFIG_NAME"
      # - name: Create and push tag from package version
      #   run: |
      #     VERSION=$(yarn --silent json -f package.json version)
      #     TAG=v${VERSION}
      #     git commit -m "ðŸš€ test$TAG_NAME" -n
      #     git tag -a "test$TAG_NAME" -m "test$TAG_NAME"
      #     git push origin "test$TAG_NAME"+

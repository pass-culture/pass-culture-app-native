name: Run Reassure performance tests

on:
  workflow_call:
    # secrets:
    #   GITHUB_TOKEN:
    #     required: true

jobs:
  test-performance:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Run performance testing script
        run: ./scripts/reassure-test.sh
      - name: Run Danger.js to publish scores in PR
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        run: yarn danger ci
      - name: Check if pipeline should fail
        run: (! grep "ðŸ”´" .reassure/output.md)

<div align=center>
  <img src="https://pass.culture.fr/wp-content/uploads/2020/11/RVB_PASS_CULTURE_HD.png" style="width: 360px">
  <br />
  <a href="https://apps.apple.com/fr/app/pass-culture/id1557887412">
    <img src="https://upload.wikimedia.org/wikipedia/commons/4/40/Download_on_the_App_Store_Badge_FRCA_RGB_blk.svg" style="height: 50px">
  </a>

  <a href="https://play.google.com/store/apps/details?id=app.passculture.webapp&hl=fr">
    <img src="https://upload.wikimedia.org/wikipedia/commons/8/8e/Google_Play_Store_badge_FR.svg" style="height: 50px; padding-left: 12px">
  </a>
</div>

---

This project has been generated by [react-native-make](https://github.com/bamlab/react-native-make).

## Getting Started

After installing `node` and `yarn`, run `yarn install` to install all the dependencies.

#### üì± Mobile

To run the mobile app on Android or iOS, you will need to follow the installation steps:

- [setup](./doc/installation/setup.md) to setup your environment
- install the [Android](./doc/installation/Android.md) or [iOS](./doc/installation/iOS.md) app

#### üíª Web

To run the web app on your browser, follow the steps [here](./doc/installation/web.md)

---

## Development

### Debugging

We use [Flipper](https://fbflipper.com/) to debug the network logs, `react-query` usage, layout, perfs... More info [here](./doc/development/debugging.md).

### Standards

In the `doc/` folder you will find the `dev standards` the team members follow:

- [code structure](./doc/standards/codeStructure.md).
- [error and crash management](./doc/standards/errorManagement.md).
- [variable naming](./doc/standards/naming.md).
- [testing strategy](./doc/standards/testStrategy.md).
- [PR title format](./doc/standards/pr-title.md).

<details>
  <summary>To add a dev standard</summary>
  
Standards can of course be improved and new ones can be added.

1.  Create a pull request with the standard modification/addition (use `TEMPLATE.md` for addition)
2.  Ask **all** team members to read your PR

> Why: so that the team is aligned on how to code, and the best way to do something is shared within all members

3.  Make sure you got the approval of every member of the team
4.  You can merge :)
</details>

### Testing

You can run the tests with `yarn test`. This command will:

- Run `eslint` on your project
- Check the typescript types
- Run the `jest` tests

You can run the jest tests in watch mode with:

```bash
yarn jest --watch
```

You can also get the coverage with:

```bash
yarn jest --coverage
```

### Local development

<details>
  <summary>üìù Update the API schema</summary>
If the backend changes the api schema, you will need to update it:

- pull the `swagger-codegen-cli-v3` image: `docker pull swaggerapi/swagger-codegen-cli-v3`
- run: `yarn generate:api:client`

If the file `src/api/gen/.swagger-codegen/VERSION` changes, make sure you locally have the desired version of `swagger-codegen-cli`, otherwise run `docker pull swaggerapi/swagger-codegen-cli-v3:3.0.24`

</details>

<details>
  <summary>To develop with a local API</summary>
  
To run the app on a development environment with a local API, you need to create a `.env.development` file :
copy the `.env.testing` configuration and update the `API_BASE_URL` setting with you local server address.

Make sure you also overload the `BATCH_API_KEY_ANDROID` and `BATCH_API_KEY_IOS` variables with the _dev_ values of the _testing_ [batch project](https://dashboard.batch.com/).

Then copy `testing.keystore` into `development.keystore` and `testing.keystore.properties` into `development.keystore.properties`. Replace the `storeFile` value in `development.keystore.properties`.

</details>

<details>
  <summary>test login credentials</summary>
  
In testing, you can use this test account to login:

- email: `pctest.jeune97.has-signed-up.v2@example.com`
- mdp: `user@AZERTY123`

See 1password for more test accounts.

</details>

<details>
  <summary>Develop locally with id-check</summary>
  
To develop locally with id-check, please follow the instructions [here](./doc/development/@pass-culture/id-check.md).
</details>

### ‚¨áÔ∏è Download

To download the **testing** app, visit Appcenter for [iOS][1] and [Android][2], or use this [url][3].
For the **staging** app, use these links for [iOS][4] and [Android][5].

‚ö†Ô∏è Make sure your device is registered in the [device list][6].

---

## Deployment

See doc about deployment process [here](./doc/deployment/deployment.md) for the mobile application.

[1]: https://appcenter.ms/orgs/pass-Culture/apps/passculture-testing-ios
[2]: https://appcenter.ms/orgs/pass-Culture/apps/passculture-testing-android
[3]: hyperurl.co/pc-testing
[4]: https://appcenter.ms/orgs/pass-Culture/apps/passculture-staging-ios
[5]: https://appcenter.ms/orgs/pass-Culture/apps/passculture-staging-android
[6]: https://www.notion.so/passcultureapp/d1b6c73219ad4784af8769243f0339f3?v=8c038f65ec4d45e59e5d7fe0d744dffe

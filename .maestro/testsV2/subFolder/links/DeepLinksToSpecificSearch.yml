appId: app.passculture.webapp
---
- stopApp
- runFlow:
    when:
      true: ${MAESTRO_APP_INSTALLED == 'true'}
    label: 'Vérification du lien vers la page offre (Lien normal - app installée)'
    commands:
      - openLink:
          link: https://passculture.app/recherche/resultats?locationFilter=%7B%22locationType%22%3A%22EVERYWHERE%22%7D&from=deeplink&tags=%5B%22optinlecture_focusjapon%22%5D&utm_campaign=test&utm_source=test&utm_medium=test
          autoVerify: true
      - assertVisible:
          text: 'Respect de ta vie privée'
          index: 2
          optional: true
      - tapOn:
          text: 'Tout accepter'
          optional: true
      - assertVisible: 'Rechercher'
      - stopApp

- runFlow:
    when:
      true: ${MAESTRO_APP_INSTALLED == 'false'}
    label: 'Vérification du lien vers la page offre (Lien normal - app non-installée)'
    commands:
      - stopApp: com.android.chrome
      - openLink:
          link: https://passculture.app/recherche/resultats?locationFilter=%7B%22locationType%22%3A%22EVERYWHERE%22%7D&from=deeplink&tags=%5B%22optinlecture_focusjapon%22%5D&utm_campaign=test&utm_source=test&utm_medium=test
          autoVerify: true
      - assertVisible:
          text: 'Respect de ta vie privée'
          index: 2
          optional: true
      - tapOn:
          text: 'Tout accepter'
          optional: true
      - assertVisible: '.*recherche/resultats.*'
      - stopApp: com.android.chrome
